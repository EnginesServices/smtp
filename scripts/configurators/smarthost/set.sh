#!/bin/sh

. /home/engines/functions/checks.sh  \r\n\r\n     echo \"smart_hostname=$smart_hostname\r\n           smart_host_port=$smart_host_port\r\n           smart_host_user=$smart_host_user\r\n           auth_type=$auth_type\r\n           enabled=$enabled\r\n           smart_host_passwd=$smart_host_passwd\" > /home/engines/scripts/configurators/saved/smarthost\r\n     \r\nrequired_values=\"enabled\"\r\ncheck_required_values \r\n\r\n\r\nif test $enabled = true\r\n then\r\n  required_values=\"smart_hostname auth_type\"\r\n  check_required_values\r\n  if ! test -z $smart_host_port\r\n    then\r\n\t smart_host_port=25\r\n  fi\r\n  \r\n echo \"*\tsmtp:$smart_hostname:$smart_host_port\"  > /home/postfix/transport.smart\r\n  if test -z $smart_host_passwd\r\n   then \t\r\n    rm /home/postfix/smarthost_passwd\r\n  else\r\n    echo \"$smart_hostname $smart_host_user:$smart_host_passwd\" > /home/postfix/smarthost_passwd\r\n    sudo -n /home/engines/scripts/engine/sudo/postmap.sh smarthost_passwd     \r\n  fi   \r\nelse\r\n\trm /home/postfix/transport.smart\r\n\trm /home/postfix/transport\r\nfi \r\n\r\n/home/engines/scripts/configurators/build_transport.sh\r\nsudo -n /home/engines/scripts/configurators/sudo/rebuild_main.sh
